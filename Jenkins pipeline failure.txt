Started by user Ronit Waghambare
Replayed #9
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /var/jenkins_home/workspace/Devopsec-pipeline
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Checkout)
[Pipeline] cleanWs
[WS-CLEANUP] Deleting project workspace...
[WS-CLEANUP] Deferred wipeout is used...
[WS-CLEANUP] done
[Pipeline] git
The recommended git tool is: NONE
No credentials specified
Cloning the remote Git repository
Cloning repository https://github.com/Ronit-Waghambare/Solarv2.git
 > git init /var/jenkins_home/workspace/Devopsec-pipeline # timeout=10
Fetching upstream changes from https://github.com/Ronit-Waghambare/Solarv2.git
 > git --version # timeout=10
 > git --version # 'git version 2.47.3'
 > git fetch --tags --force --progress -- https://github.com/Ronit-Waghambare/Solarv2.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.com/Ronit-Waghambare/Solarv2.git # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
Avoid second fetch
 > git rev-parse refs/remotes/origin/main^{commit} # timeout=10
Checking out Revision 54d611297de0d07febbd9a0238d37e447245ae28 (refs/remotes/origin/main)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 54d611297de0d07febbd9a0238d37e447245ae28 # timeout=10
 > git branch -a -v --no-abbrev # timeout=10
 > git checkout -b main 54d611297de0d07febbd9a0238d37e447245ae28 # timeout=10
Commit message: "2"
 > git rev-list --no-walk 54d611297de0d07febbd9a0238d37e447245ae28 # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Install Trivy)
[Pipeline] sh
+ apt-get update
Hit:1 http://deb.debian.org/debian trixie InRelease
Hit:2 http://deb.debian.org/debian trixie-updates InRelease
Hit:3 http://deb.debian.org/debian-security trixie-security InRelease
Reading package lists...
+ apt-get install -y curl
Reading package lists...
Building dependency tree...
Reading state information...
curl is already the newest version (8.14.1-2+deb13u2).
0 upgraded, 0 newly installed, 0 to remove and 3 not upgraded.
+ curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh
+ sh
aquasecurity/trivy info checking GitHub for latest tag
aquasecurity/trivy info found version: 0.68.2 for v0.68.2/Linux/64bit
aquasecurity/trivy info installed ./bin/trivy
+ ./bin/trivy --version
Version: 0.68.2
Check Bundle:
  Digest: sha256:0491169789b867ae5a7353381220c1d4d97b3a0d6d9dfd84a25d06f0ba68aa93
  DownloadedAt: 2025-12-19 20:40:06.484266235 +0000 UTC
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Install Terraform)
[Pipeline] sh
+ apt-get update
Hit:1 http://deb.debian.org/debian trixie InRelease
Hit:2 http://deb.debian.org/debian trixie-updates InRelease
Hit:3 http://deb.debian.org/debian-security trixie-security InRelease
Reading package lists...
+ apt-get install -y unzip wget
Reading package lists...
Building dependency tree...
Reading state information...
unzip is already the newest version (6.0-29).
wget is already the newest version (1.25.0-2).
0 upgraded, 0 newly installed, 0 to remove and 3 not upgraded.
+ cd /tmp
+ rm -f terraform_1.6.6_linux_amd64.zip terraform
+ wget https://releases.hashicorp.com/terraform/1.6.6/terraform_1.6.6_linux_amd64.zip
--2025-12-20 09:50:21--  https://releases.hashicorp.com/terraform/1.6.6/terraform_1.6.6_linux_amd64.zip
Resolving releases.hashicorp.com (releases.hashicorp.com)... 18.172.64.38, 18.172.64.91, 18.172.64.46, ...
Connecting to releases.hashicorp.com (releases.hashicorp.com)|18.172.64.38|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 24976120 (24M) [application/zip]
Saving to: â€˜terraform_1.6.6_linux_amd64.zipâ€™

     0K .......... .......... .......... .......... ..........  0% 1.25M 19s
    50K .......... .......... .......... .......... ..........  0% 1.95M 16s
   100K .......... .......... .......... .......... ..........  0% 1.12M 17s
   150K .......... .......... .......... .......... ..........  0%  688K 22s
   200K .......... .......... .......... .......... ..........  1% 1.33M 21s
   250K .......... .......... .......... .......... ..........  1% 3.36M 19s
   300K .......... .......... .......... .......... ..........  1%  856K 20s
   350K .......... .......... .......... .......... ..........  1% 6.70M 18s
   400K .......... .......... .......... .......... ..........  1% 4.69M 16s
   450K .......... .......... .......... .......... ..........  2% 2.16M 16s
   500K .......... .......... .......... .......... ..........  2% 14.8M 14s
   550K .......... .......... .......... .......... ..........  2% 4.25M 14s
   600K .......... .......... .......... .......... ..........  2% 2.55M 13s
   650K .......... .......... .......... .......... ..........  2% 10.8M 12s
   700K .......... .......... .......... .......... ..........  3% 41.7M 12s
   750K .......... .......... .......... .......... ..........  3% 2.87M 11s
   800K .......... .......... .......... .......... ..........  3% 2.04M 11s
   850K .......... .......... .......... .......... ..........  3% 5.94M 11s
   900K .......... .......... .......... .......... ..........  3% 2.36M 11s
   950K .......... .......... .......... .......... ..........  4% 5.02M 11s
  1000K .......... .......... .......... .......... ..........  4% 1.34M 11s
  1050K .......... .......... .......... .......... ..........  4% 1.43M 11s
  1100K .......... .......... .......... .......... ..........  4% 3.20M 11s
  1150K .......... .......... .......... .......... ..........  4% 2.07M 11s
  1200K .......... .......... .......... .......... ..........  5%  802K 12s
  1250K .......... .......... .......... .......... ..........  5%  827K 12s
  1300K .......... .......... .......... .......... ..........  5% 1.42M 12s
  1350K .......... .......... .......... .......... ..........  5% 3.51M 12s
  1400K .......... .......... .......... .......... ..........  5%  413K 13s
  1450K .......... .......... .......... .......... ..........  6% 1.67M 13s
  1500K .......... .......... .......... .......... ..........  6% 1.92M 13s
  1550K .......... .......... .......... .......... ..........  6% 2.89M 13s
  1600K .......... .......... .......... .......... ..........  6% 5.37M 13s
  1650K .......... .......... .......... .......... ..........  6% 1.77M 13s
  1700K .......... .......... .......... .......... ..........  7% 1.57M 13s
  1750K .......... .......... .......... .......... ..........  7% 2.70M 13s
  1800K .......... .......... .......... .......... ..........  7% 2.97M 12s
  1850K .......... .......... .......... .......... ..........  7% 3.67M 12s
  1900K .......... .......... .......... .......... ..........  7% 2.06M 12s
  1950K .......... .......... .......... .......... ..........  8% 2.43M 12s
  2000K .......... .......... .......... .......... ..........  8%  609K 13s
  2050K .......... .......... .......... .......... ..........  8%  649K 13s
  2100K .......... .......... .......... .......... ..........  8% 2.16M 13s
  2150K .......... .......... .......... .......... ..........  9% 1.64M 13s
  2200K .......... .......... .......... .......... ..........  9% 2.63M 13s
  2250K .......... .......... .......... .......... ..........  9% 10.1M 13s
  2300K .......... .......... .......... .......... ..........  9% 3.73M 12s
  2350K .......... .......... .......... .......... ..........  9% 3.71M 12s
  2400K .......... .......... .......... .......... .......... 10% 2.67M 12s
  2450K .......... .......... .......... .......... .......... 10% 5.32M 12s
  2500K .......... .......... .......... .......... .......... 10% 1.76M 12s
  2550K .......... .......... .......... .......... .......... 10% 4.44M 12s
  2600K .......... .......... .......... .......... .......... 10%  825K 12s
  2650K .......... .......... .......... .......... .......... 11%  762K 12s
  2700K .......... .......... .......... .......... .......... 11% 2.94M 12s
  2750K .......... .......... .......... .......... .......... 11% 2.66M 12s
  2800K .......... .......... .......... .......... .......... 11% 6.54M 12s
  2850K .......... .......... .......... .......... .......... 11% 1.43M 12s
  2900K .......... .......... .......... .......... .......... 12% 2.22M 12s
  2950K .......... .......... .......... .......... .......... 12% 1.21M 12s
  3000K .......... .......... .......... .......... .......... 12% 1.97M 12s
  3050K .......... .......... .......... .......... .......... 12%  996K 12s
  3100K .......... .......... .......... .......... .......... 12% 1.71M 12s
  3150K .......... .......... .......... .......... .......... 13% 2.29M 12s
  3200K .......... .......... .......... .......... .......... 13% 2.54M 12s
  3250K .......... .......... .......... .......... .......... 13% 3.63M 12s
  3300K .......... .......... .......... .......... .......... 13% 1.79M 12s
  3350K .......... .......... .......... .......... .......... 13% 2.18M 12s
  3400K .......... .......... .......... .......... .......... 14% 3.61M 12s
  3450K .......... .......... .......... .......... .......... 14% 2.03M 11s
  3500K .......... .......... .......... .......... .......... 14%  956K 12s
  3550K .......... .......... .......... .......... .......... 14% 3.31M 11s
  3600K .......... .......... .......... .......... .......... 14% 1.13M 12s
  3650K .......... .......... .......... .......... .......... 15% 6.77M 11s
  3700K .......... .......... .......... .......... .......... 15% 1.93M 11s
  3750K .......... .......... .......... .......... .......... 15% 2.78M 11s
  3800K .......... .......... .......... .......... .......... 15% 2.26M 11s
  3850K .......... .......... .......... .......... .......... 15% 4.75M 11s
  3900K .......... .......... .......... .......... .......... 16% 2.31M 11s
  3950K .......... .......... .......... .......... .......... 16% 1.78M 11s
  4000K .......... .......... .......... .......... .......... 16% 2.85M 11s
  4050K .......... .......... .......... .......... .......... 16% 3.45M 11s
  4100K .......... .......... .......... .......... .......... 17% 4.24M 11s
  4150K .......... .......... .......... .......... .......... 17% 3.29M 11s
  4200K .......... .......... .......... .......... .......... 17% 2.72M 11s
  4250K .......... .......... .......... .......... .......... 17% 3.09M 11s
  4300K .......... .......... .......... .......... .......... 17% 1.39M 11s
  4350K .......... .......... .......... .......... .......... 18% 3.91M 10s
  4400K .......... .......... .......... .......... .......... 18% 1.68M 10s
  4450K .......... .......... .......... .......... .......... 18% 1.35M 10s
  4500K .......... .......... .......... .......... .......... 18% 3.99M 10s
  4550K .......... .......... .......... .......... .......... 18%  671K 11s
  4600K .......... .......... .......... .......... .......... 19%  460K 11s
  4650K .......... .......... .......... .......... .......... 19% 1.90M 11s
  4700K .......... .......... .......... .......... .......... 19% 1.60M 11s
  4750K .......... .......... .......... .......... .......... 19% 2.71M 11s
  4800K .......... .......... .......... .......... .......... 19% 2.66M 11s
  4850K .......... .......... .......... .......... .......... 20% 3.50M 11s
  4900K .......... .......... .......... .......... .......... 20% 1.39M 11s
  4950K .......... .......... .......... .......... .......... 20% 1.73M 11s
  5000K .......... .......... .......... .......... .......... 20% 4.64M 10s
  5050K .......... .......... .......... .......... .......... 20% 3.52M 10s
  5100K .......... .......... .......... .......... .......... 21% 3.61M 10s
  5150K .......... .......... .......... .......... .......... 21% 1.79M 10s
  5200K .......... .......... .......... .......... .......... 21% 7.96M 10s
  5250K .......... .......... .......... .......... .......... 21% 4.00M 10s
  5300K .......... .......... .......... .......... .......... 21% 2.12M 10s
  5350K .......... .......... .......... .......... .......... 22% 3.56M 10s
  5400K .......... .......... .......... .......... .......... 22% 3.97M 10s
  5450K .......... .......... .......... .......... .......... 22% 2.43M 10s
  5500K .......... .......... .......... .......... .......... 22% 6.50M 10s
  5550K .......... .......... .......... .......... .......... 22% 4.82M 10s
  5600K .......... .......... .......... .......... .......... 23% 2.79M 10s
  5650K .......... .......... .......... .......... .......... 23% 4.44M 10s
  5700K .......... .......... .......... .......... .......... 23% 4.38M 10s
  5750K .......... .......... .......... .......... .......... 23% 6.37M 9s
  5800K .......... .......... .......... .......... .......... 23% 2.98M 9s
  5850K .......... .......... .......... .......... .......... 24% 2.62M 9s
  5900K .......... .......... .......... .......... .......... 24% 4.93M 9s
  5950K .......... .......... .......... .......... .......... 24% 3.24M 9s
  6000K .......... .......... .......... .......... .......... 24% 4.84M 9s
  6050K .......... .......... .......... .......... .......... 25% 3.01M 9s
  6100K .......... .......... .......... .......... .......... 25% 5.54M 9s
  6150K .......... .......... .......... .......... .......... 25% 2.28M 9s
  6200K .......... .......... .......... .......... .......... 25% 3.16M 9s
  6250K .......... .......... .......... .......... .......... 25% 8.19M 9s
  6300K .......... .......... .......... .......... .......... 26% 4.57M 9s
  6350K .......... .......... .......... .......... .......... 26% 5.44M 9s
  6400K .......... .......... .......... .......... .......... 26% 1.08M 9s
  6450K .......... .......... .......... .......... .......... 26%  182K 9s
  6500K .......... .......... .......... .......... .......... 26% 55.5M 9s
  6550K .......... .......... .......... .......... .......... 27% 63.9M 9s
  6600K .......... .......... .......... .......... .......... 27% 69.6M 9s
  6650K .......... .......... .......... .......... .......... 27% 70.9M 9s
  6700K .......... .......... .......... .......... .......... 27% 51.7M 9s
  6750K .......... .......... .......... .......... .......... 27% 59.4M 9s
  6800K .......... .......... .......... .......... .......... 28% 57.7M 9s
  6850K .......... .......... .......... .......... .......... 28% 64.0M 9s
  6900K .......... .......... .......... .......... .......... 28% 2.72M 9s
  6950K .......... .......... .......... .......... .......... 28% 3.26M 9s
  7000K .......... .......... .......... .......... .......... 28% 3.07M 9s
  7050K .......... .......... .......... .......... .......... 29% 2.22M 9s
  7100K .......... .......... .......... .......... .......... 29% 3.61M 8s
  7150K .......... .......... .......... .......... .......... 29% 5.48M 8s
  7200K .......... .......... .......... .......... .......... 29% 2.31M 8s
  7250K .......... .......... .......... .......... .......... 29% 4.23M 8s
  7300K .......... .......... .......... .......... .......... 30% 6.12M 8s
  7350K .......... .......... .......... .......... .......... 30% 2.92M 8s
  7400K .......... .......... .......... .......... .......... 30% 4.10M 8s
  7450K .......... .......... .......... .......... .......... 30% 2.90M 8s
  7500K .......... .......... .......... .......... .......... 30% 5.97M 8s
  7550K .......... .......... .......... .......... .......... 31% 4.75M 8s
  7600K .......... .......... .......... .......... .......... 31% 9.85M 8s
  7650K .......... .......... .......... .......... .......... 31% 1.61M 8s
  7700K .......... .......... .......... .......... .......... 31% 45.9M 8s
  7750K .......... .......... .......... .......... .......... 31% 5.55M 8s
  7800K .......... .......... .......... .......... .......... 32% 7.84M 8s
  7850K .......... .......... .......... .......... .......... 32% 2.80M 8s
  7900K .......... .......... .......... .......... .......... 32% 43.9M 8s
  7950K .......... .......... .......... .......... .......... 32% 3.20M 8s
  8000K .......... .......... .......... .......... .......... 33% 6.47M 8s
  8050K .......... .......... .......... .......... .......... 33% 4.37M 8s
  8100K .......... .......... .......... .......... .......... 33% 3.28M 7s
  8150K .......... .......... .......... .......... .......... 33% 4.48M 7s
  8200K .......... .......... .......... .......... .......... 33% 3.65M 7s
  8250K .......... .......... .......... .......... .......... 34% 5.61M 7s
  8300K .......... .......... .......... .......... .......... 34% 3.38M 7s
  8350K .......... .......... .......... .......... .......... 34% 5.58M 7s
  8400K .......... .......... .......... .......... .......... 34% 6.06M 7s
  8450K .......... .......... .......... .......... .......... 34% 4.00M 7s
  8500K .......... .......... .......... .......... .......... 35% 3.18M 7s
  8550K .......... .......... .......... .......... .......... 35% 5.85M 7s
  8600K .......... .......... .......... .......... .......... 35% 3.74M 7s
  8650K .......... .......... .......... .......... .......... 35% 2.52M 7s
  8700K .......... .......... .......... .......... .......... 35% 3.13M 7s
  8750K .......... .......... .......... .......... .......... 36% 2.80M 7s
  8800K .......... .......... .......... .......... .......... 36% 4.07M 7s
  8850K .......... .......... .......... .......... .......... 36% 5.12M 7s
  8900K .......... .......... .......... .......... .......... 36% 4.70M 7s
  8950K .......... .......... .......... .......... .......... 36% 4.29M 7s
  9000K .......... .......... .......... .......... .......... 37% 3.14M 7s
  9050K .......... .......... .......... .......... .......... 37% 6.34M 7s
  9100K .......... .......... .......... .......... .......... 37% 2.70M 7s
  9150K .......... .......... .......... .......... .......... 37% 2.96M 7s
  9200K .......... .......... .......... .......... .......... 37% 5.47M 7s
  9250K .......... .......... .......... .......... .......... 38% 3.34M 7s
  9300K .......... .......... .......... .......... .......... 38% 1.31M 7s
  9350K .......... .......... .......... .......... .......... 38% 1.81M 7s
  9400K .......... .......... .......... .......... .......... 38% 1.97M 7s
  9450K .......... .......... .......... .......... .......... 38% 2.79M 6s
  9500K .......... .......... .......... .......... .......... 39% 2.66M 6s
  9550K .......... .......... .......... .......... .......... 39% 2.99M 6s
  9600K .......... .......... .......... .......... .......... 39% 1.34M 6s
  9650K .......... .......... .......... .......... .......... 39% 1.66M 6s
  9700K .......... .......... .......... .......... .......... 39% 2.20M 6s
  9750K .......... .......... .......... .......... .......... 40% 3.72M 6s
  9800K .......... .......... .......... .......... .......... 40% 3.65M 6s
  9850K .......... .......... .......... .......... .......... 40% 2.47M 6s
  9900K .......... .......... .......... .......... .......... 40% 2.86M 6s
  9950K .......... .......... .......... .......... .......... 40% 1.78M 6s
 10000K .......... .......... .......... .......... .......... 41% 2.22M 6s
 10050K .......... .......... .......... .......... .......... 41% 1.53M 6s
 10100K .......... .......... .......... .......... .......... 41% 2.52M 6s
 10150K .......... .......... .......... .......... .......... 41%  428K 6s
 10200K .......... .......... .......... .......... .......... 42%  315K 6s
 10250K .......... .......... .......... .......... .......... 42%  796K 7s
 10300K .......... .......... .......... .......... .......... 42% 1.66M 7s
 10350K .......... .......... .......... .......... .......... 42% 1.43M 7s
 10400K .......... .......... .......... .......... .......... 42% 1.11M 7s
 10450K .......... .......... .......... .......... .......... 43% 4.86M 6s
 10500K .......... .......... .......... .......... .......... 43% 1.11M 6s
 10550K .......... .......... .......... .......... .......... 43% 2.84M 6s
 10600K .......... .......... .......... .......... .......... 43% 3.61M 6s
 10650K .......... .......... .......... .......... .......... 43% 2.72M 6s
 10700K .......... .......... .......... .......... .......... 44% 3.52M 6s
 10750K .......... .......... .......... .......... .......... 44% 1.91M 6s
 10800K .......... .......... .......... .......... .......... 44% 5.37M 6s
 10850K .......... .......... .......... .......... .......... 44% 3.12M 6s
 10900K .......... .......... .......... .......... .......... 44% 10.6M 6s
 10950K .......... .......... .......... .......... .......... 45% 8.38M 6s
 11000K .......... .......... .......... .......... .......... 45% 7.46M 6s
 11050K .......... .......... .......... .......... .......... 45% 4.32M 6s
 11100K .......... .......... .......... .......... .......... 45% 2.80M 6s
 11150K .......... .......... .......... .......... .......... 45% 4.12M 6s
 11200K .......... .......... .......... .......... .......... 46% 5.27M 6s
 11250K .......... .......... .......... .......... .......... 46% 12.7M 6s
 11300K .......... .......... .......... .......... .......... 46% 3.65M 6s
 11350K .......... .......... .......... .......... .......... 46% 2.55M 6s
 11400K .......... .......... .......... .......... .......... 46% 4.25M 6s
 11450K .......... .......... .......... .......... .......... 47% 1.49M 6s
 11500K .......... .......... .......... .......... .......... 47% 2.85M 6s
 11550K .......... .......... .......... .......... .......... 47% 3.11M 6s
 11600K .......... .......... .......... .......... .......... 47% 4.67M 6s
 11650K .......... .......... .......... .......... .......... 47% 5.17M 6s
 11700K .......... .......... .......... .......... .......... 48% 6.13M 6s
 11750K .......... .......... .......... .......... .......... 48% 3.58M 6s
 11800K .......... .......... .......... .......... .......... 48% 4.08M 6s
 11850K .......... .......... .......... .......... .......... 48% 1.69M 6s
 11900K .......... .......... .......... .......... .......... 48% 1.34M 6s
 11950K .......... .......... .......... .......... .......... 49% 2.64M 6s
 12000K .......... .......... .......... .......... .......... 49% 3.00M 6s
 12050K .......... .......... .......... .......... .......... 49% 1.71M 5s
 12100K .......... .......... .......... .......... .......... 49% 2.27M 5s
 12150K .......... .......... .......... .......... .......... 50% 1.43M 5s
 12200K .......... .......... .......... .......... .......... 50% 2.17M 5s
 12250K .......... .......... .......... .......... .......... 50% 3.42M 5s
 12300K .......... .......... .......... .......... .......... 50% 3.16M 5s
 12350K .......... .......... .......... .......... .......... 50% 2.30M 5s
 12400K .......... .......... .......... .......... .......... 51% 3.86M 5s
 12450K .......... .......... .......... .......... .......... 51% 3.55M 5s
 12500K .......... .......... .......... .......... .......... 51% 2.83M 5s
 12550K .......... .......... .......... .......... .......... 51% 3.81M 5s
 12600K .......... .......... .......... .......... .......... 51% 1.70M 5s
 12650K .......... .......... .......... .......... .......... 52% 22.5M 5s
 12700K .......... .......... .......... .......... .......... 52% 2.10M 5s
 12750K .......... .......... .......... .......... .......... 52%  958K 5s
 12800K .......... .......... .......... .......... .......... 52% 1.42M 5s
 12850K .......... .......... .......... .......... .......... 52% 3.57M 5s
 12900K .......... .......... .......... .......... .......... 53% 1.07M 5s
 12950K .......... .......... .......... .......... .......... 53% 2.88M 5s
 13000K .......... .......... .......... .......... .......... 53% 1.88M 5s
 13050K .......... .......... .......... .......... .......... 53% 3.55M 5s
 13100K .......... .......... .......... .......... .......... 53% 2.31M 5s
 13150K .......... .......... .......... .......... .......... 54% 2.71M 5s
 13200K .......... .......... .......... .......... .......... 54% 2.04M 5s
 13250K .......... .......... .......... .......... .......... 54% 3.55M 5s
 13300K .......... .......... .......... .......... .......... 54% 2.38M 5s
 13350K .......... .......... .......... .......... .......... 54% 1.37M 5s
 13400K .......... .......... .......... .......... .......... 55% 3.13M 5s
 13450K .......... .......... .......... .......... .......... 55% 2.69M 5s
 13500K .......... .......... .......... .......... .......... 55% 4.50M 5s
 13550K .......... .......... .......... .......... .......... 55% 2.46M 5s
 13600K .......... .......... .......... .......... .......... 55% 1.90M 5s
 13650K .......... .......... .......... .......... .......... 56% 1.23M 5s
 13700K .......... .......... .......... .......... .......... 56% 2.70M 5s
 13750K .......... .......... .......... .......... .......... 56% 3.53M 5s
 13800K .......... .......... .......... .......... .......... 56% 2.29M 5s
 13850K .......... .......... .......... .......... .......... 56% 4.86M 5s
 13900K .......... .......... .......... .......... .......... 57% 3.00M 5s
 13950K .......... .......... .......... .......... .......... 57% 3.03M 5s
 14000K .......... .......... .......... .......... .......... 57% 3.53M 5s
 14050K .......... .......... .......... .......... .......... 57% 2.88M 5s
 14100K .......... .......... .......... .......... .......... 58% 3.54M 5s
 14150K .......... .......... .......... .......... .......... 58% 3.48M 4s
 14200K .......... .......... .......... .......... .......... 58% 3.91M 4s
 14250K .......... .......... .......... .......... .......... 58% 2.43M 4s
 14300K .......... .......... .......... .......... .......... 58% 4.30M 4s
 14350K .......... .......... .......... .......... .......... 59% 3.43M 4s
 14400K .......... .......... .......... .......... .......... 59% 6.89M 4s
 14450K .......... .......... .......... .......... .......... 59% 3.68M 4s
 14500K .......... .......... .......... .......... .......... 59% 3.37M 4s
 14550K .......... .......... .......... .......... .......... 59% 4.20M 4s
 14600K .......... .......... .......... .......... .......... 60% 6.93M 4s
 14650K .......... .......... .......... .......... .......... 60% 3.38M 4s
 14700K .......... .......... .......... .......... .......... 60% 10.8M 4s
 14750K .......... .......... .......... .......... .......... 60% 3.05M 4s
 14800K .......... .......... .......... .......... .......... 60% 1.76M 4s
 14850K .......... .......... .......... .......... .......... 61% 2.07M 4s
 14900K .......... .......... .......... .......... .......... 61% 2.33M 4s
 14950K .......... .......... .......... .......... .......... 61% 2.02M 4s
 15000K .......... .......... .......... .......... .......... 61% 2.11M 4s
 15050K .......... .......... .......... .......... .......... 61% 3.09M 4s
 15100K .......... .......... .......... .......... .......... 62% 3.33M 4s
 15150K .......... .......... .......... .......... .......... 62% 8.06M 4s
 15200K .......... .......... .......... .......... .......... 62% 6.60M 4s
 15250K .......... .......... .......... .......... .......... 62% 5.56M 4s
 15300K .......... .......... .......... .......... .......... 62% 3.24M 4s
 15350K .......... .......... .......... .......... .......... 63% 4.21M 4s
 15400K .......... .......... .......... .......... .......... 63% 2.51M 4s
 15450K .......... .......... .......... .......... .......... 63% 3.80M 4s
 15500K .......... .......... .......... .......... .......... 63% 4.29M 4s
 15550K .......... .......... .......... .......... .......... 63% 2.11M 4s
 15600K .......... .......... .......... .......... .......... 64% 4.89M 4s
 15650K .......... .......... .......... .......... .......... 64% 3.26M 4s
 15700K .......... .......... .......... .......... .......... 64% 7.68M 4s
 15750K .......... .......... .......... .......... .......... 64% 3.60M 4s
 15800K .......... .......... .......... .......... .......... 64% 3.44M 4s
 15850K .......... .......... .......... .......... .......... 65% 4.43M 4s
 15900K .......... .......... .......... .......... .......... 65% 2.00M 4s
 15950K .......... .......... .......... .......... .......... 65% 3.46M 4s
 16000K .......... .......... .......... .......... .......... 65% 2.71M 4s
 16050K .......... .......... .......... .......... .......... 66% 2.81M 4s
 16100K .......... .......... .......... .......... .......... 66% 7.00M 3s
 16150K .......... .......... .......... .......... .......... 66% 5.85M 3s
 16200K .......... .......... .......... .......... .......... 66% 2.64M 3s
 16250K .......... .......... .......... .......... .......... 66% 2.58M 3s
 16300K .......... .......... .......... .......... .......... 67% 3.32M 3s
 16350K .......... .......... .......... .......... .......... 67% 2.94M 3s
 16400K .......... .......... .......... .......... .......... 67% 3.74M 3s
 16450K .......... .......... .......... .......... .......... 67% 2.88M 3s
 16500K .......... .......... .......... .......... .......... 67% 2.20M 3s
 16550K .......... .......... .......... .......... .......... 68% 3.76M 3s
 16600K .......... .......... .......... .......... .......... 68% 2.06M 3s
 16650K .......... .......... .......... .......... .......... 68% 1.64M 3s
 16700K .......... .......... .......... .......... .......... 68% 2.02M 3s
 16750K .......... .......... .......... .......... .......... 68% 1.87M 3s
 16800K .......... .......... .......... .......... .......... 69% 2.59M 3s
 16850K .......... .......... .......... .......... .......... 69% 12.7M 3s
 16900K .......... .......... .......... .......... .......... 69% 4.09M 3s
 16950K .......... .......... .......... .......... .......... 69% 2.93M 3s
 17000K .......... .......... .......... .......... .......... 69% 3.46M 3s
 17050K .......... .......... .......... .......... .......... 70% 2.69M 3s
 17100K .......... .......... .......... .......... .......... 70% 4.10M 3s
 17150K .......... .......... .......... .......... .......... 70% 3.63M 3s
 17200K .......... .......... .......... .......... .......... 70% 3.65M 3s
 17250K .......... .......... .......... .......... .......... 70% 5.43M 3s
 17300K .......... .......... .......... .......... .......... 71% 1.81M 3s
 17350K .......... .......... .......... .......... .......... 71% 1.58M 3s
 17400K .......... .......... .......... .......... .......... 71% 4.95M 3s
 17450K .......... .......... .......... .......... .......... 71% 2.58M 3s
 17500K .......... .......... .......... .......... .......... 71% 2.93M 3s
 17550K .......... .......... .......... .......... .......... 72% 34.0M 3s
 17600K .......... .......... .......... .......... .......... 72% 4.31M 3s
 17650K .......... .......... .......... .......... .......... 72% 7.25M 3s
 17700K .......... .......... .......... .......... .......... 72% 4.32M 3s
 17750K .......... .......... .......... .......... .......... 72% 4.32M 3s
 17800K .......... .......... .......... .......... .......... 73% 5.46M 3s
 17850K .......... .......... .......... .......... .......... 73% 5.06M 3s
 17900K .......... .......... .......... .......... .......... 73% 4.63M 3s
 17950K .......... .......... .......... .......... .......... 73% 4.42M 3s
 18000K .......... .......... .......... .......... .......... 74% 4.38M 3s
 18050K .......... .......... .......... .......... .......... 74% 3.75M 3s
 18100K .......... .......... .......... .......... .......... 74% 2.67M 3s
 18150K .......... .......... .......... .......... .......... 74% 2.62M 3s
 18200K .......... .......... .......... .......... .......... 74% 3.12M 3s
 18250K .......... .......... .......... .......... .......... 75% 4.56M 2s
 18300K .......... .......... .......... .......... .......... 75% 2.63M 2s
 18350K .......... .......... .......... .......... .......... 75% 2.80M 2s
 18400K .......... .......... .......... .......... .......... 75% 1.68M 2s
 18450K .......... .......... .......... .......... .......... 75% 6.67M 2s
 18500K .......... .......... .......... .......... .......... 76% 1.96M 2s
 18550K .......... .......... .......... .......... .......... 76% 4.46M 2s
 18600K .......... .......... .......... .......... .......... 76%  472K 2s
 18650K .......... .......... .......... .......... .......... 76%  962K 2s
 18700K .......... .......... .......... .......... .......... 76% 3.58M 2s
 18750K .......... .......... .......... .......... .......... 77% 1.47M 2s
 18800K .......... .......... .......... .......... .......... 77% 1.97M 2s
 18850K .......... .......... .......... .......... .......... 77% 1.18M 2s
 18900K .......... .......... .......... .......... .......... 77% 2.22M 2s
 18950K .......... .......... .......... .......... .......... 77% 3.20M 2s
 19000K .......... .......... .......... .......... .......... 78% 3.11M 2s
 19050K .......... .......... .......... .......... .......... 78% 1.74M 2s
 19100K .......... .......... .......... .......... .......... 78% 3.22M 2s
 19150K .......... .......... .......... .......... .......... 78% 5.60M 2s
 19200K .......... .......... .......... .......... .......... 78% 4.12M 2s
 19250K .......... .......... .......... .......... .......... 79% 4.32M 2s
 19300K .......... .......... .......... .......... .......... 79% 3.38M 2s
 19350K .......... .......... .......... .......... .......... 79% 1.88M 2s
 19400K .......... .......... .......... .......... .......... 79% 2.35M 2s
 19450K .......... .......... .......... .......... .......... 79% 1.80M 2s
 19500K .......... .......... .......... .......... .......... 80% 2.48M 2s
 19550K .......... .......... .......... .......... .......... 80% 2.55M 2s
 19600K .......... .......... .......... .......... .......... 80% 4.47M 2s
 19650K .......... .......... .......... .......... .......... 80% 3.63M 2s
 19700K .......... .......... .......... .......... .......... 80% 5.82M 2s
 19750K .......... .......... .......... .......... .......... 81% 3.18M 2s
 19800K .......... .......... .......... .......... .......... 81% 3.30M 2s
 19850K .......... .......... .......... .......... .......... 81% 4.60M 2s
 19900K .......... .......... .......... .......... .......... 81% 8.59M 2s
 19950K .......... .......... .......... .......... .......... 81% 4.99M 2s
 20000K .......... .......... .......... .......... .......... 82% 5.05M 2s
 20050K .......... .......... .......... .......... .......... 82% 3.17M 2s
 20100K .......... .......... .......... .......... .......... 82% 4.30M 2s
 20150K .......... .......... .......... .......... .......... 82% 6.78M 2s
 20200K .......... .......... .......... .......... .......... 83% 3.82M 2s
 20250K .......... .......... .......... .......... .......... 83% 2.93M 2s
 20300K .......... .......... .......... .......... .......... 83% 2.80M 2s
 20350K .......... .......... .......... .......... .......... 83% 6.09M 2s
 20400K .......... .......... .......... .......... .......... 83% 4.98M 2s
 20450K .......... .......... .......... .......... .......... 84% 3.91M 2s
 20500K .......... .......... .......... .......... .......... 84% 7.19M 2s
 20550K .......... .......... .......... .......... .......... 84% 7.55M 2s
 20600K .......... .......... .......... .......... .......... 84% 7.41M 2s
 20650K .......... .......... .......... .......... .......... 84% 6.45M 1s
 20700K .......... .......... .......... .......... .......... 85% 1.82M 1s
 20750K .......... .......... .......... .......... .......... 85% 3.47M 1s
 20800K .......... .......... .......... .......... .......... 85% 3.56M 1s
 20850K .......... .......... .......... .......... .......... 85% 3.59M 1s
 20900K .......... .......... .......... .......... .......... 85% 2.93M 1s
 20950K .......... .......... .......... .......... .......... 86% 8.28M 1s
 21000K .......... .......... .......... .......... .......... 86% 13.0M 1s
 21050K .......... .......... .......... .......... .......... 86% 4.82M 1s
 21100K .......... .......... .......... .......... .......... 86% 3.54M 1s
 21150K .......... .......... .......... .......... .......... 86% 6.77M 1s
 21200K .......... .......... .......... .......... .......... 87% 5.42M 1s
 21250K .......... .......... .......... .......... .......... 87% 3.28M 1s
 21300K .......... .......... .......... .......... .......... 87% 1.96M 1s
 21350K .......... .......... .......... .......... .......... 87% 1.88M 1s
 21400K .......... .......... .......... .......... .......... 87% 5.52M 1s
 21450K .......... .......... .......... .......... .......... 88% 3.90M 1s
 21500K .......... .......... .......... .......... .......... 88% 2.44M 1s
 21550K .......... .......... .......... .......... .......... 88% 2.86M 1s
 21600K .......... .......... .......... .......... .......... 88% 1.92M 1s
 21650K .......... .......... .......... .......... .......... 88% 3.15M 1s
 21700K .......... .......... .......... .......... .......... 89% 4.00M 1s
 21750K .......... .......... .......... .......... .......... 89% 2.68M 1s
 21800K .......... .......... .......... .......... .......... 89% 1.64M 1s
 21850K .......... .......... .......... .......... .......... 89% 1.99M 1s
 21900K .......... .......... .......... .......... .......... 89% 4.97M 1s
 21950K .......... .......... .......... .......... .......... 90% 1.88M 1s
 22000K .......... .......... .......... .......... .......... 90% 2.38M 1s
 22050K .......... .......... .......... .......... .......... 90% 1.80M 1s
 22100K .......... .......... .......... .......... .......... 90% 2.49M 1s
 22150K .......... .......... .......... .......... .......... 91% 5.97M 1s
 22200K .......... .......... .......... .......... .......... 91% 3.42M 1s
 22250K .......... .......... .......... .......... .......... 91% 3.06M 1s
 22300K .......... .......... .......... .......... .......... 91% 4.32M 1s
 22350K .......... .......... .......... .......... .......... 91% 4.81M 1s
 22400K .......... .......... .......... .......... .......... 92% 2.25M 1s
 22450K .......... .......... .......... .......... .......... 92% 5.33M 1s
 22500K .......... .......... .......... .......... .......... 92% 4.24M 1s
 22550K .......... .......... .......... .......... .......... 92% 3.85M 1s
 22600K .......... .......... .......... .......... .......... 92% 3.45M 1s
 22650K .......... .......... .......... .......... .......... 93% 5.90M 1s
 22700K .......... .......... .......... .......... .......... 93% 4.90M 1s
 22750K .......... .......... .......... .......... .......... 93% 6.69M 1s
 22800K .......... .......... .......... .......... .......... 93% 2.89M 1s
 22850K .......... .......... .......... .......... .......... 93% 3.76M 1s
 22900K .......... .......... .......... .......... .......... 94% 3.55M 1s
 22950K .......... .......... .......... .......... .......... 94% 4.53M 1s
 23000K .......... .......... .......... .......... .......... 94% 2.04M 1s
 23050K .......... .......... .......... .......... .......... 94% 2.32M 1s
 23100K .......... .......... .......... .......... .......... 94% 1.60M 0s
 23150K .......... .......... .......... .......... .......... 95% 2.25M 0s
 23200K .......... .......... .......... .......... .......... 95% 3.14M 0s
 23250K .......... .......... .......... .......... .......... 95% 3.15M 0s
 23300K .......... .......... .......... .......... .......... 95% 2.38M 0s
 23350K .......... .......... .......... .......... .......... 95% 5.54M 0s
 23400K .......... .......... .......... .......... .......... 96% 3.80M 0s
 23450K .......... .......... .......... .......... .......... 96% 3.25M 0s
 23500K .......... .......... .......... .......... .......... 96% 3.25M 0s
 23550K .......... .......... .......... .......... .......... 96% 1.76M 0s
 23600K .......... .......... .......... .......... .......... 96% 3.19M 0s
 23650K .......... .......... .......... .......... .......... 97% 2.40M 0s
 23700K .......... .......... .......... .......... .......... 97% 3.86M 0s
 23750K .......... .......... .......... .......... .......... 97% 5.91M 0s
 23800K .......... .......... .......... .......... .......... 97% 4.76M 0s
 23850K .......... .......... .......... .......... .......... 97% 3.77M 0s
 23900K .......... .......... .......... .......... .......... 98% 2.19M 0s
 23950K .......... .......... .......... .......... .......... 98% 2.43M 0s
 24000K .......... .......... .......... .......... .......... 98% 3.92M 0s
 24050K .......... .......... .......... .......... .......... 98% 6.41M 0s
 24100K .......... .......... .......... .......... .......... 99% 7.23M 0s
 24150K .......... .......... .......... .......... .......... 99% 4.55M 0s
 24200K .......... .......... .......... .......... .......... 99% 4.52M 0s
 24250K .......... .......... .......... .......... .......... 99% 5.41M 0s
 24300K .......... .......... .......... .......... .......... 99% 2.67M 0s
 24350K .......... .......... .......... ..........           100% 10.8M=9.5s

2025-12-20 09:50:31 (2.51 MB/s) - â€˜terraform_1.6.6_linux_amd64.zipâ€™ saved [24976120/24976120]

+ unzip -o terraform_1.6.6_linux_amd64.zip
Archive:  terraform_1.6.6_linux_amd64.zip
  inflating: terraform               
+ chmod +x terraform
+ mv terraform /usr/local/bin/
+ terraform -version
Terraform v1.6.6
on linux_amd64

Your version of Terraform is out of date! The latest version
is 1.14.3. You can update by downloading from https://www.terraform.io/downloads.html
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Terraform Security Scan)
[Pipeline] sh
+ ./bin/trivy config terraform/ --severity HIGH,CRITICAL
2025-12-20T09:50:38Z	INFO	[misconfig] Misconfiguration scanning is enabled
2025-12-20T09:50:43Z	INFO	[terraform scanner] Scanning root module	file_path="."
2025-12-20T09:50:44Z	INFO	Detected config files	num=3

Report Summary

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Target       â”‚   Type    â”‚ Misconfigurations â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .                 â”‚ terraform â”‚         0         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ec2.tf            â”‚ terraform â”‚         2         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ security_group.tf â”‚ terraform â”‚         2         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)


ec2.tf (terraform)
==================
Tests: 2 (SUCCESSES: 0, FAILURES: 2)
Failures: 2 (HIGH: 2, CRITICAL: 0)

AVD-AWS-0028 (HIGH): Instance does not require IMDS access to require a token.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.

By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.

To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.


See https://avd.aquasec.com/misconfig/avd-aws-0028
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ec2.tf:1-11
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”Œ resource "aws_instance" "web" {
   2 â”‚   ami           = "ami-0f5ee92e2d63afc18"
   3 â”‚   instance_type = "t2.micro"
   4 â”‚   key_name      = "Devopsec"
   5 â”‚ 
   6 â”‚   vpc_security_group_ids = [aws_security_group.web_sg.id]
   7 â”‚ 
   8 â”‚   tags = {
   9 â””     Name = "DevSecOps-Web"
  ..   
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


AVD-AWS-0131 (HIGH): Root block device is not encrypted.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Block devices should be encrypted to ensure sensitive data is held securely at rest.


See https://avd.aquasec.com/misconfig/avd-aws-0131
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ec2.tf:1-11
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”Œ resource "aws_instance" "web" {
   2 â”‚   ami           = "ami-0f5ee92e2d63afc18"
   3 â”‚   instance_type = "t2.micro"
   4 â”‚   key_name      = "Devopsec"
   5 â”‚ 
   6 â”‚   vpc_security_group_ids = [aws_security_group.web_sg.id]
   7 â”‚ 
   8 â”‚   tags = {
   9 â””     Name = "DevSecOps-Web"
  ..   
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€



security_group.tf (terraform)
=============================
Tests: 2 (SUCCESSES: 0, FAILURES: 2)
Failures: 2 (HIGH: 1, CRITICAL: 1)

AVD-AWS-0104 (CRITICAL): Security group rule allows unrestricted egress to any IP address.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 security_group.tf:22
   via security_group.tf:18-23 (egress)
    via security_group.tf:1-24 (aws_security_group.web_sg)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   resource "aws_security_group" "web_sg" {
   .   
  22 [     cidr_blocks = ["0.0.0.0/0"]
  ..   
  24   }
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 security_group.tf:8
   via security_group.tf:4-9 (ingress)
    via security_group.tf:1-24 (aws_security_group.web_sg)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1   resource "aws_security_group" "web_sg" {
   .   
   8 [     cidr_blocks = ["0.0.0.0/0"]   # âŒ Vulnerability
  ..   
  24   }
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Terraform Init & Plan)
[Pipeline] sh
+ cd terraform
+ terraform init

[0m[1mInitializing the backend...[0m

[0m[1mInitializing provider plugins...[0m
- Finding latest version of hashicorp/aws...
- Installing hashicorp/aws v6.27.0...
- Installed hashicorp/aws v6.27.0 (signed by HashiCorp)

Terraform has created a lock file [1m.terraform.lock.hcl[0m to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run "terraform init" in the future.[0m

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
+ terraform plan

[0m[1m[31mPlanning failed.[0m[1m Terraform encountered an error while generating this plan.[0m

[0m[31mâ•·[0m[0m
[31mâ”‚[0m [0m[1m[31mError: [0m[0m[1mNo valid credential sources found[0m
[31mâ”‚[0m [0m
[31mâ”‚[0m [0m[0m  with provider["registry.terraform.io/hashicorp/aws"],
[31mâ”‚[0m [0m  on provider.tf line 1, in provider "aws":
[31mâ”‚[0m [0m   1: provider "aws" [4m{[0m[0m
[31mâ”‚[0m [0m
[31mâ”‚[0m [0mPlease see https://registry.terraform.io/providers/hashicorp/aws
[31mâ”‚[0m [0mfor more information about providing credentials.
[31mâ”‚[0m [0m
[31mâ”‚[0m [0mError: failed to refresh cached credentials, no EC2 IMDS role found,
[31mâ”‚[0m [0moperation error ec2imds: GetMetadata, exceeded maximum number of attempts,
[31mâ”‚[0m [0m3, request send failed, Get
[31mâ”‚[0m [0m"http://169.254.169.254/latest/meta-data/iam/security-credentials/": dial
[31mâ”‚[0m [0mtcp 169.254.169.254:80: connect: connection refused
[31mâ”‚[0m [0m
[31mâ•µ[0m[0m
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
ERROR: script returned exit code 1
Finished: FAILURE
